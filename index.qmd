---
title: "Quantification of ion scattering by solar wind discontinuities: pitch-angle diffusion rates"
abstract: Because solar wind plasma flow transports the entire spectrum of magnetic field fluctuations (from low-frequency inertial range to electron kinetic range), it is a natural laboratory for plasma turbulence investigation. Among the various wave modes and coherent plasma structures that contribute to this spectrum, one of the most important solar wind elements is ion-scale solar wind discontinuities. These structures, which carry very intense current, have been considered as a free energy source for plasma instabilities that contribute to solar wind heating. Investigations of such discontinuities have been mostly focused on their magnetic field signatures; much less is known about their role in scattering of energetic ions. In this study, we consider observational-based model of ion dynamics and scattering in force-free rotational magnetic discontinuities. Focusing on quantification of the scattering effect, we demonstrate that background sheared magnetic field plays an important role in determining the efficiency of pitch angle scattering. We provide a model included statistical properties of solar wind discontinuities and providing estimates of ion scattering rate.
author:
  - name: Zijin Zhang
    corresponding: true
    email: zijin@ucla.edu
    roles: [investigation, software, visualization]
    affiliations:
      - ref: ucla
  - name: Anton Artemyev
    orcid: 0000-0001-8823-4474
    roles: [conceptualization, writing]
    affiliations:
      - ref: ucla
---

```{=html}
<!-- 
Figure 1: two examples of discontinuity observations in ARTEMIS data (gse magnetic field, solar wind speed in gse, lmn magnetic field, ion omnidirection spectrum) with hodographs and fitting Bm(Bl)
Figure 2: distribution of kappa_m, thickness L/di, distributions of energies estimated from L=\rhoi equation
Figure 3: typical examples of ion trajectories (6 panels for different km, alpha) in 3D; use both initial z>0 and z<0 to show difference in dynamics
Figure 4: phase portraits in (kx, px) for a few km and alpha (boundaries and different colors for two/one potential wells)
Figure 5: Poincare maps for several km and alpha
Figure 6: several examples of (px_init, px_final) matrix for different km and alpha; the same matrix in pitch-angle space; most of results for z<0 (well scattered particles) and a couple examples for z>0
Figure 7: (km, alpha) space with color showing averaged over 10% variance of pitch-angle maximum (over initial px).
Figure 8, 9-10: these will be results of mapping technique for which we can use your maxtrixes. Let us discuss what do with this figures, as they should show the effective scattering rate that is more universal than pitch-angle variance 
-->
```

# Introduction

The transport of energetic particles within the heliosphere is significantly influenced by the turbulent magnetic field present in the solar wind. However, this turbulence should not be regarded merely as a collection of random magnetic field fluctuations. Instead, the nonlinear energy cascade process results in the formation of coherent structures. These coherent structures have been shown to act as efficient particle scatterers in non-collisional plasmas [@artemyevSuperfastIonScattering2020; @malaraChargedparticleChaoticDynamics2021].

We investigated the interaction of ions with rotational discontinuities by employing a simplified analytical model for the magnetic field configuration. Our study aimed to examine how the particle pitch angle is influenced by the parameters of the magnetic field configuration and the initial conditions of the particles.

# Basic Equations

We assume the following 1-D force-free magnetic field configuration where $\mathbf{B}$ depends only on the $z$ coordinate:

$$
\mathbf{B} = B_0 (\cos θ \ \mathbf{e_z} + \sin θ ( \sin φ(z) \ \mathbf{e_x} + \cos φ (z) \ \mathbf{e_y})) 
$$

where $B_0$ is the magnitude of the magnetic field, $θ$ is the azimuthal angle between the normal $\mathbf{B_z} = B_0 \cos θ \ \mathbf{e_z} \equiv B_n \mathbf{e_z}$ and the magnetic field. More specifically we assume the following form, $φ(z) = β \tanh(z/L)$, where $L$ is the thickness of the current sheet and $β$ is the half of in plane rotation angle $ω_{in}$. The transverse magnetic field component $\mathbf{B_t} = B_t \sin φ(z) \ \mathbf{e_x} + B_t \cos φ (z) \ \mathbf{e_y}$ rotates by an angle $ω_{in}$ from $-∞$ to $+∞$ where $B_t = B_0 \sin θ$.

The motion of a particle in such a field can be expressed in the Hamiltonian formalism as follows:

$$
 H = \frac{1}{2m} \left( \mathbf{p} - q \mathbf{A} \right)^2
$$

where $\mathbf{A}$ represents the magnetic vector potential, $\mathbf{p}$ is the canonical momentum. More specifically, the magnetic vector potential $\mathbf{A}$ can be expressed in an exact integrable form:

$$
\begin{aligned}
A_x &= L B_t f_1(z)
\\
A_y &= L B_t f_2(z) + x B_n
\\
A_z &= 0
\end{aligned}
$$

$$
\begin{aligned}
f_1(z) = \frac{1}{2} \cos β \ \left(\text{Ci}\left(β +β \tanh \left(\frac{z}{L}\right)  \right)-\text{Ci}\left(β -β  \tanh \left(\frac{z}{L}\right)\right)\right)+ \frac{1}{2} \sin β \ \left(\text{Si}\left(β +β \tanh \left(\frac{z}{L}\right) \right)-\text{Si}\left(β -β  \tanh \left(\frac{z}{L}\right)\right)\right),
\\
f_2(z) = \frac{1}{2}  \sin β \ \left(\text{Ci}\left(β +β \tanh \left(\frac{z}{L}\right)  \right)+\text{Ci}\left(β -β  \tanh \left(\frac{z}{L}\right)\right)\right) - \frac{1}{2} \cos β \ \left(\text{Si}\left(β +β \tanh \left(\frac{z}{L}\right)  \right)+\text{Si}\left(β -β  \tanh \left(\frac{z}{L}\right)\right)\right)
\end{aligned}
$$

We introduce a dimensionless Hamiltonian $\tilde{H} = H / h$ by normalizing $(x, z) = (\tilde{x} L + c_x, \tilde{z} L)$ and $(p_x, p_z) = p (\tilde{p_x}, \tilde{p_z})$ where $p = \frac{q L B_t}{c}$ and $h = \frac{q^2 L^2 B_t^2}{m c^2}$. Note that because $∂H/∂y = 0$, $p_y = \text{const}$ and we could let $c_x = \frac{c p_y}{q B_n}$ to elinimate $y$:

$$
\tilde{H} = \frac{1}{2} \left(\left(\tilde{p_x}-f_1(z)\right)^2+\left(\tilde{x} \cot θ + f_2(z)\right)^2+\tilde{p_z}^2\right)
$$

It is important to note that this is an exact Hamiltonian of the particle dynamic. We do not expand it near the neutral plane $z=0$ like previous study employing the Hamiltonian formalism [@artemyevSuperfastIonScattering2020]. This Hamiltonian also include the rotation effect $β$. Expand the Hamiltonian near the current sheet to the third order and assume that $β=1$ we could reduce to the Hamiltonian form in @artemyevSuperfastIonScattering2020 where $κ = \cot θ$. In this study, we quantitatively investigate the role of $β$ and particle energy $E$ in the pitch-angle scattering efficiency. In the following discussion, the tilde notation over the dimensionless variable is omitted for simplicity.

# Adiabatic invariance and its violations at separatrix crossings

For discontinuities where $B_n / B_t ≪ 1$, the variables $(κ x, p_x)$ evolve significantly more slowly compared to $(z, p_z)$. Assuming that $x$ and $p_x$ are effectively frozen, the Hamiltonian describes a periodic motion within the $(z, p_z)$ plane, governed by the effective potential energy $U(z) = H - p_z^2$. When variations in $(κ x, p_x)$ occur on a timescale much longer than the fast oscillations in $(z, p_z)$, the generalized magnetic moment $I_z = (2 π)^{-1} ∮ p_z dz$ is conserved as an adiabatic invariant with exponential accuracy [@neishtadtAccuracyPersistenceAdiabatic2000].

This Hamiltonian supports two distinct types of ion motion in the $(z, p_z)$ plane, as illustrated in @fig-zPz_phase. In the left portrait, there are two potential wells, resulting in one or two possible orbits in the $(z, p_z)$ plane depending on the value of $H$. In contrast, the right portrait represents a case with only one possible orbit in the $(z, p_z)$ plane for a fixed $H$. As $(κ x, p_x)$ evolve slowly, the particle's trajectory in the $(z, p_z)$ plane undergoes a gradual transformation. Transitions between motion types can occur, accompanied by significant trajectory reconfigurations when the particle crosses the separatrix. Near the separatrix, the instantaneous period of motion increases logarithmically, diverging as the trajectory approaches it. When the timescales of fast oscillations and variations in the control parameter become comparable, the particle accumulates a nonvanishing change in the adiabatic invariant, resulting in a jump in $I_z$ of approximately $\sim 1$. This jump arises primarily from the geometrical destruction of adiabatic invariance [@artemyevSuperfastIonScattering2020], and corresponds to the difference in areas enclosed by the separatrix in the $(z, p_z)$ plane which is independent of $κ$. Concurrently, the projection of the particle's phase point onto the $(κ x, p_x)$ plane lies along the so-called uncertainty curve, which demarcates regions corresponding to different types of motion in the $(z, p_z)$ plane.

::: {#fig-zPz_phase}
![](figures/zPz_phase_portraits.pdf)

Phase portraits of Hamiltonian at frozen $(κx, p_x)$ for $β = 1$: $H$ values of each curve are shown in the plot; $κ x = 4, p_x = 1$ in the left panel and $κx = 0, p_x = 0.5$ in the right panel.
:::

Due to the symmetry of ion motion about the $p_z = 0$ line, the potential energy $U$ reaches a local maximum along the $z$-direction at the saddle point $z = z_c, p_z = 0$ where two lobes connect. At this point, the conditions $∂ U/∂ z = 0$ and $∂^2 U/∂ z^2 < 0$ are satisfied. These conditions allow the expression of the slow variables along the uncertainty curve in the $(κ x, p_x)$ plane as functions of $z_c$. When a particle trajectory crosses the $z = 0$ plane, the crossing point is confined within a circular region defined by $(p_x - f_1(0))^2 + (\kappa x + f_2(0))^2 = 2H$. The likelihood of the trajectory intersecting the uncertainty curve is therefore proportional to the uncertainty curve length $L_{\text{uc}}$, normalized by the square root of the particle energy, $\sqrt{H}$, as illustrated in @fig-UCLength. For fixed $H$, $L_{\text{uc}}/\sqrt{H}$ increases with $β$, indicating higher scattering probabilities at larger magnetic field rotation angles. Similarly, at a fixed $β$, $L_{\text{uc}}/\sqrt{H}$ increases with $H$, suggesting that high-energy ions are more susceptible to pitch-angle scattering. 

::: {#fig-UCLength}
![Density plot of the uncertainty curve length $L_{\text{uc}}/\sqrt{H}$ as a function of $β$ and normalized particle energy $H$, overlaid with constant contour curves.](figures/UCLength.pdf)
:::

# Test particle simulations

To quantitatively analyze how particles are scattered by solar wind discontinuities, we conducted extensive test particle simulations using a dataset of solar wind current sheets at 1 AU. Since the primary focus is on protons, the particle mass was set to $m_p$ (proton mass) and the charge to the elementary charge $q$. According to the dimensionless Hamiltonian, the critical current sheet parameters influencing particle dynamics are the angles $θ$ and $β = ω_{in}/2$, along with the parameter $B_t L$, which appears in the dimensionless factor $h = \frac{q^2 L^2 B_t^2}{m c^2}$. By applying a simple transformation, $B_t = B_0 \sin θ$, the key current sheet parameters become $θ$, $ω_{in}$, and $v_0 = Ω_0 L = q B_0 L / (c m_p)$, where $Ω_0$ is the gyrofrequency associated with the magnetic field $B_0$.

Using data from the Wind mission, we compiled a dataset of 100,000 discontinuities. The orientations of these discontinuities were determined using the minimum variance analysis of the magnetic field (MVAB) method. Accurate orientation determination was crucial for estimating the discontinuities' thickness ($L$) and the in-plane magnetic field rotation angle ($ω_{in}$), both of which significantly influence ion scattering. To ensure reliability, only discontinuities with $Δ|B|/|B| > 0.05$ or $ω > 60°$ were used in the following analysis, as these conditions improve the accuracy of the MVAB method, as noted by @liuFailuresMinimumVariance2023. The two parameters $Δ|B|/|B| > 0.05$ and $ω > 60°$ are independent of the discontinuity normal and can be calculated directly from magnetic field data. 
@fig-windHist3D shows 3D density plots of the azimuthal angle $θ$, the in-plane rotation angle $ω_{in}$, and the logarithm of the characteristic velocity $\log v_0$, categorized by whether the accuracy conditions are satisfied (left for not accurate, right for accurate). Current sheets with accurately determined orientations typically have smaller azimuthal angles $θ$, indicating a smaller $B_n$, and moderate in-plane rotation angles $ω_{in}$. In contrast, current sheets with potentially inaccurate normal orientations display larger $θ$ (larger $B_n$) and larger $ω_{in}$. The most probable values observed in the distribution are a characteristic velocity ($v_0$) of approximately 250 km/s, an in-plane rotation angle ($ω_{in}$) near 100 degrees, and an azimuthal angle (\theta) around 85-95 degrees.

![3D density plots of the azimuthal angle $θ$, in-plane rotation angle $ω_{in}$, and logarithm of the characteristic velocity $\log v_0$. The left panel corresponds to cases where the accuracy conditions are not satisfied, while the right panel represents cases where they are satisfied.](figures/wind_hist3d.png)

For each magnetic field configuration, we initialize an ensemble of particles with different pitch angle $α_0$ and gyro phase $ψ_0$ that are far away from the current sheet center (i.e., $|z_0| > 6 L + 2 r_g$ where $r_g$ is the gyro radius). We numerically integrate the particle motion until the particle has completely left the current sheet (i.e., $|z(t)| > |z_0| + 2 r_g$). We track the particle final pitch angle $α_1$ and construct the transition matrix (TM), that describes the probability for pitch-angle change $∆α= α_1−α_0$ for a single interaction. @fig-tm-example illustrates the transition matrix for particle of ??? keV (left) and ???keV (right) in magnetic field configuration with $θ = 85°, β = 60°, L = ?$. Enhanced probability around the diagonal of TM corresponds to weakly scattered SEPs, ∆α = 0. Spreading around the diagonal indicates the diffusive scattering, and the probability of large pitch-angle jumps are described by essentially non-diagonal elements.

::: {#fig-tm-example}
![θ = 85°, β = 60°](figures/tm/example_subset.png)

:::

# Long-term pitch angle evolution

Long-term modeling of particle pitch-angle distributions resulting from current-sheet scattering involves simulating the dynamics of a large number of particles through multiple current-sheet interactions over extended periods. To reduce computational time and complexity, we derive a simplified probabilistic description of pitch-angle evolution for modeling energetic particle transport under current-sheet scattering. 
The scattering process depends on the particle's initial conditions, $(\mathbf{r}, \mathbf{v})$, as well as the configuration of the current sheet, $\mathbf{B}$. In the 1D model, these initial conditions can be expressed in terms of $z, E_0, α_0$, and $ψ_0$. Since our primary interest lies in the pitch angle after the particle exits the current sheet, and the energy $E_0$ remains constant in the absence of an electric field, the initial energy $E_0$ and position $z$ (provided the particle is sufficiently far from the center of the current sheet) can be omitted from further consideration.

The final pitch angle, however, is highly sensitive to initial conditions $(α_0, ψ_0)$, where small variations in the gyro phase can lead to significantly different final pitch angles. Therefore, the scattering process $\Pi : (α_0, ψ_0) \to (α_1, ψ_1)$ is better represented as a probabilistic transition $p(α_1 | α_0, \Pi)$, with the probability derived through numerical interpolation of the transition matrix. Here, $\Pi$ characterizes the current sheet configuration. This probabilistic representation is further justified by the fact that the gyro phase depends on the particle's location and may undergo random shifts during the crossing of a current sheet. Additionally, numerical integration methods, such as the Boris method, introduce a phase error proportional to $Δ t$, making the gyro phase less reliable. Thus, it is more appropriate to model the gyro phase as a random variable. This probabilistic approach eliminates dependence on the gyro phase, focusing instead on the statistical relationship between the initial pitch angle $α_0$ and the final pitch angle $α_1$, as governed by the properties of the current sheets.

From the obtained profile of the transition matrix under various current sheet configurations, the long-term behavior of particle pitch angles can be characterized as a combination of intermediate diffusion and large pitch-angle jumps. For instance, during interactions with current sheets featuring a large shear angle $β$, particles in the ensemble may experience significant pitch-angle jumps. These large jumps are followed by more frequent interactions with current sheets with smaller shear angles, leading to a gradual diffusion of particles in pitch angle. This interplay between large non-diffusive jumps and continuous diffusive processes suggests a dynamic evolution of the particle ensemble, where the overall pitch-angle distribution reflects the combined effects of both scattering regimes. Over time, this results in a broadened and redistributed pitch-angle profile, governed by the statistical nature of the interactions with the solar wind current sheets.

For particles with a specific energy, a weighted transition matrix (WTM) can be constructed over the observed distribution of SWDs: $p(α_1 | α_0) = \sum_{i} p(α_1 | α_0, \Pi_i) w_i$, where the weight $w_i$ corresponds to the occurrence probabilities of specific SWD configurations. The WTM accounts for the varying likelihoods of particles encountering SWDs with different properties and encapsulates the overall probability of a particle undergoing a pitch-angle jump at 1 AU due to interactions with an ensemble of SWDs.

::: {#fig-tm-stats-100keV}
![](figures/tm/tm_stats_100keV.png)

Transition matrix for 100 keV particles.
:::

As shown in @fig-tm-stats-100keV, the WTM for 100 keV protons at 1 AU indicates a strong probability of minimal pitch-angle changes, evident from the prominent bright diagonal, as well as significant probabilities associated with diffusive scattering. Notably, it also reveals a considerable likelihood of large pitch-angle changes. These large-angle jumps result from scattering on SWDs with characteristic scales $L$ that are comparable to or smaller than the gyroradius of 100 keV protons. Such strong scattering cannot be adequately described by diffusion alone. However, the WTM can be directly employed to simulate the long-term evolution of particles' pitch-angle distributions using stochastic difference equation, as described in @eq-mapping:

$$
α_{n+1,i} = W\left(α_{n,i}, ξ_{n,i}\right)
$$ {#eq-mapping}

where $n$ is the number of interaction (interaction with SWD), $i$ is the particle index within the ensemble, and $W\left(α_{n,i}, ξ_{n,i}\right)$ determines pitch-angle change from the WTM and a given random variable $ξ_{n,i}$, which is sampled from a uniform distribution.

@fig-pa-jump-history illustrates two characteristic solutions of the dynamical equation (pitch-angle mapping) based on the WTM evaluated at 1 AU. The pitch-angle dynamics are primarily governed by infrequent but substantial jumps, which could result in the reflection of particles from the discontinuity, indicated by a reversal in the sign of $\cos α$.

::: {#fig-pa-jump-history}
![](figures/pa_jump_history.png)

![](figures/pa_jump_history_high.png)

Examples of ion pitch angle scattering by solar wind discontinuities for different energies.
:::

However, directly incorporating stochastic difference equations and WTM into classical numerical schemes for transport diffusion equations is a non-trivial task. To facilitate comparison with other scattering processes and to enable the inclusion of SWD scattering effects in such models, we evaluate the averaged scattering rate, $D$. This rate serves as a global diffusion coefficient, independent of the local pitch angle, as high-energy particles frequently experience large pitch-angle jumps. The scattering rate is determined by the characteristics of the WTM and the particle energy. Using the mapping described in @eq-mapping for an ensemble of particles, we evaluate the evolution of the second moment of the pitch-angle distribution:

$$
\begin{aligned}
M_1(n) = N^{-1}∑_{i=1}^N (α_{n,i} - α_{0,i})
\\
M_2(n) = N^{-1}∑_{i=1}^N (α_{n,i} - α_{0,i})^2 - M_1^2(n)
\end{aligned}
$$

where $M_1(n)$ represents the mean shift in the pitch angle, and $M_2(n)$ quantifies the spreading of particles in pitch-angle space. The function $M_2(n)$ increases linearly with the number of interactions (the number of interactions with SWDs) before reaching saturation, where the pitch-angle distribution becomes fully mixed. This linear behavior is illustrated in @fig-mixing-rate. By fitting $M_2(n)$ with a linear model $D n$ , we determine the scattering rate $D$ , which depends on the particle energy and the WTM. These scattering rates are analogous to diffusion coefficients for pitch-angle scattering and can be directly incorporated into transport-diffusion simulations, providing a simplified yet effective way to account for SWD-induced scattering in broader energetic particle models.

::: {#fig-mixing-rate}
![](figures/mixing_rate.pdf)

:::

# Conclusion

In this study, we have investigated the scattering of energetic particles by solar wind discontinuities. We have provided a model that includes statistical properties of solar wind discontinuities and provides estimates of pitch angle scattering rates.

<!-- Solar wind discontinuities are important coherent structures in the solar wind that can effectively scatter energetic particles. -->